
/* !!! This is code generated by Prisma. Do not edit directly. !!! */
/* eslint-disable */
// biome-ignore-all lint: generated file
// @ts-nocheck 
import * as $runtime from "@prisma/client/runtime/client"

/**
 * @param fromRevisionId
 * @param toRevisionId
 * @param tableCreatedId (optional, for filtering, NULL for all tables)
 * @param searchTerm (optional, for searching by rowId, NULL to disable)
 * @param changeTypes (optional, array of change types to filter, NULL for all)
 * @param limit
 * @param offset
 * @param includeSystem (optional, whether to include system tables, default FALSE)
 */
export const getRowChangesPaginatedBetweenRevisions = $runtime.makeTypedQueryFactory("\nWITH parent_rows AS (\nSELECT\nr.\"id\",\nr.\"createdId\",\nr.\"versionId\",\nr.\"data\",\nr.\"hash\",\nr.\"schemaHash\",\nr.\"updatedAt\",\nr.\"publishedAt\",\nr.\"createdAt\",\nt.\"id\" as \"tableId\",\nt.\"createdId\" as \"tableCreatedId\"\nFROM \"Row\" r\nINNER JOIN \"_RowToTable\" rt ON r.\"versionId\" = rt.\"A\"\nINNER JOIN \"Table\" t ON t.\"versionId\" = rt.\"B\"\nINNER JOIN \"_RevisionToTable\" revt ON t.\"versionId\" = revt.\"B\"\nWHERE revt.\"A\" = $1\nAND ($3::text IS NULL OR t.\"createdId\" = $3)\nAND ($8::boolean IS TRUE OR t.\"system\" = FALSE)\n),\nchild_rows AS (\nSELECT\nr.\"id\",\nr.\"createdId\",\nr.\"versionId\",\nr.\"data\",\nr.\"hash\",\nr.\"schemaHash\",\nr.\"updatedAt\",\nr.\"publishedAt\",\nr.\"createdAt\",\nt.\"id\" as \"tableId\",\nt.\"createdId\" as \"tableCreatedId\"\nFROM \"Row\" r\nINNER JOIN \"_RowToTable\" rt ON r.\"versionId\" = rt.\"A\"\nINNER JOIN \"Table\" t ON t.\"versionId\" = rt.\"B\"\nINNER JOIN \"_RevisionToTable\" revt ON t.\"versionId\" = revt.\"B\"\nWHERE revt.\"A\" = $2\nAND ($3::text IS NULL OR t.\"createdId\" = $3)\nAND ($8::boolean IS TRUE OR t.\"system\" = FALSE)\n),\nall_changes AS (\nSELECT\npr.\"id\" AS \"fromRowId\",\nCOALESCE(cr.\"createdId\", pr.\"createdId\") AS \"rowCreatedId\",\npr.\"versionId\" AS \"fromVersionId\",\npr.\"data\" AS \"fromData\",\npr.\"hash\" AS \"fromHash\",\npr.\"schemaHash\" AS \"fromSchemaHash\",\npr.\"tableId\" AS \"fromTableId\",\nCOALESCE(cr.\"tableCreatedId\", pr.\"tableCreatedId\") AS \"tableCreatedId\",\npr.\"createdAt\" AS \"fromCreatedAt\",\n\ncr.\"id\" AS \"toRowId\",\ncr.\"versionId\" AS \"toVersionId\",\ncr.\"data\" AS \"toData\",\ncr.\"hash\" AS \"toHash\",\ncr.\"schemaHash\" AS \"toSchemaHash\",\ncr.\"tableId\" AS \"toTableId\",\nCOALESCE(cr.\"updatedAt\", pr.\"updatedAt\") AS \"updatedAt\",\nCOALESCE(cr.\"publishedAt\", pr.\"publishedAt\") AS \"publishedAt\",\nCOALESCE(cr.\"createdAt\", pr.\"createdAt\") AS \"createdAt\",\n\nCASE\nWHEN pr.\"createdId\" IS NULL THEN 'ADDED'\nWHEN cr.\"createdId\" IS NULL THEN 'REMOVED'\nWHEN pr.\"id\" != cr.\"id\" AND cr.\"hash\" != pr.\"hash\" THEN 'RENAMED_AND_MODIFIED'\nWHEN pr.\"id\" != cr.\"id\" THEN 'RENAMED'\nWHEN cr.\"hash\" != pr.\"hash\" THEN 'MODIFIED'\nEND AS \"changeType\"\n\nFROM child_rows cr\nFULL OUTER JOIN parent_rows pr USING (\"createdId\")\nWHERE\n(pr.\"createdId\" IS NULL OR\ncr.\"createdId\" IS NULL OR\npr.\"id\" != cr.\"id\" OR\ncr.\"hash\" != pr.\"hash\")\n)\nSELECT * FROM all_changes\nWHERE\n($4::text IS NULL OR\n\"fromRowId\" ILIKE '%' || $4 || '%' OR\n\"toRowId\" ILIKE '%' || $4 || '%')\nAND ($5::jsonb IS NULL OR \"changeType\" = ANY(ARRAY(SELECT jsonb_array_elements_text($5::jsonb))))\nORDER BY\n\"updatedAt\" DESC,\n\"rowCreatedId\" ASC\nLIMIT $6\nOFFSET $7") as (fromRevisionId: string, toRevisionId: string, tableCreatedId: string, searchTerm: string, changeTypes: $runtime.InputJsonObject, limit: number, offset: number, includeSystem: boolean) => $runtime.TypedSql<getRowChangesPaginatedBetweenRevisions.Parameters, getRowChangesPaginatedBetweenRevisions.Result>

export namespace getRowChangesPaginatedBetweenRevisions {
  export type Parameters = [fromRevisionId: string, toRevisionId: string, tableCreatedId: string, searchTerm: string, changeTypes: $runtime.InputJsonObject, limit: number, offset: number, includeSystem: boolean]
  export type Result = {
    fromRowId: string
    rowCreatedId: string | null
    fromVersionId: string
    fromData: $runtime.JsonValue
    fromHash: string
    fromSchemaHash: string
    fromTableId: string
    tableCreatedId: string | null
    fromCreatedAt: Date
    toRowId: string
    toVersionId: string
    toData: $runtime.JsonValue
    toHash: string
    toSchemaHash: string
    toTableId: string
    updatedAt: Date | null
    publishedAt: Date | null
    createdAt: Date | null
    changeType: string | null
  }
}
