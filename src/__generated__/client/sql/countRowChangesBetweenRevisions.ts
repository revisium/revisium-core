
/* !!! This is code generated by Prisma. Do not edit directly. !!! */
/* eslint-disable */
// biome-ignore-all lint: generated file
// @ts-nocheck 
import * as $runtime from "@prisma/client/runtime/client"

/**
 * @param fromRevisionId
 * @param toRevisionId
 * @param tableCreatedId (optional, NULL for all tables)
 * @param searchTerm (optional, for searching by rowId, NULL to disable)
 * @param changeTypes (optional, array of change types to filter, NULL for all)
 * @param changeSources (optional, array of change sources to filter, NULL for all)
 * @param includeSystem (optional, whether to include system tables, default FALSE)
 */
export const countRowChangesBetweenRevisions = $runtime.makeTypedQueryFactory("\nWITH parent_rows AS (\nSELECT\nr.\"id\",\nr.\"createdId\",\nr.\"hash\",\nr.\"schemaHash\"\nFROM \"Row\" r\nINNER JOIN \"_RowToTable\" rt ON r.\"versionId\" = rt.\"A\"\nINNER JOIN \"Table\" t ON t.\"versionId\" = rt.\"B\"\nINNER JOIN \"_RevisionToTable\" revt ON t.\"versionId\" = revt.\"B\"\nWHERE revt.\"A\" = $1\nAND ($3::text IS NULL OR t.\"createdId\" = $3)\nAND ($7::boolean IS TRUE OR t.\"system\" = FALSE)\n),\nchild_rows AS (\nSELECT\nr.\"id\",\nr.\"createdId\",\nr.\"hash\",\nr.\"schemaHash\"\nFROM \"Row\" r\nINNER JOIN \"_RowToTable\" rt ON r.\"versionId\" = rt.\"A\"\nINNER JOIN \"Table\" t ON t.\"versionId\" = rt.\"B\"\nINNER JOIN \"_RevisionToTable\" revt ON t.\"versionId\" = revt.\"B\"\nWHERE revt.\"A\" = $2\nAND ($3::text IS NULL OR t.\"createdId\" = $3)\nAND ($7::boolean IS TRUE OR t.\"system\" = FALSE)\n),\nall_changes AS (\nSELECT\nCASE\nWHEN pr.\"createdId\" IS NULL THEN 'ADDED'\nWHEN cr.\"createdId\" IS NULL THEN 'REMOVED'\nWHEN pr.\"id\" != cr.\"id\" THEN 'RENAMED'\nWHEN cr.\"hash\" != pr.\"hash\" THEN 'MODIFIED'\nEND AS \"changeType\",\nCASE\nWHEN pr.\"schemaHash\" IS NULL OR cr.\"schemaHash\" IS NULL THEN 'DATA'\nWHEN cr.\"schemaHash\" != pr.\"schemaHash\" THEN 'SCHEMA'\nELSE 'DATA'\nEND AS \"changeSource\",\npr.\"id\" AS \"fromRowId\",\ncr.\"id\" AS \"toRowId\"\nFROM child_rows cr\nFULL OUTER JOIN parent_rows pr USING (\"createdId\")\nWHERE\n(pr.\"createdId\" IS NULL OR\ncr.\"createdId\" IS NULL OR\npr.\"id\" != cr.\"id\" OR\ncr.\"hash\" != pr.\"hash\")\n)\nSELECT\nCOUNT(*) AS \"count\"\nFROM all_changes\nWHERE\n($4::text IS NULL OR\n\"fromRowId\" ILIKE '%' || $4 || '%' OR\n\"toRowId\" ILIKE '%' || $4 || '%')\nAND ($5::jsonb IS NULL OR \"changeType\" = ANY(ARRAY(SELECT jsonb_array_elements_text($5::jsonb))))\nAND ($6::jsonb IS NULL OR \"changeSource\" = ANY(ARRAY(SELECT jsonb_array_elements_text($6::jsonb))))") as (fromRevisionId: string, toRevisionId: string, tableCreatedId: string, searchTerm: string, changeTypes: $runtime.InputJsonObject, changeSources: $runtime.InputJsonObject, includeSystem: boolean) => $runtime.TypedSql<countRowChangesBetweenRevisions.Parameters, countRowChangesBetweenRevisions.Result>

export namespace countRowChangesBetweenRevisions {
  export type Parameters = [fromRevisionId: string, toRevisionId: string, tableCreatedId: string, searchTerm: string, changeTypes: $runtime.InputJsonObject, changeSources: $runtime.InputJsonObject, includeSystem: boolean]
  export type Result = {
    count: bigint | null
  }
}
